<div id="maindiv" class="row main-wrapper">
    <!-- Main Content Area (Centered, Modern style) -->
    <div class="col-sm-12">
        <!-- UPLOAD SECTION (Masking as Task Creation) -->
        <div ng-if="mode == 'upload'">
            <!-- TodoTrack Logo -->
            <div class="todotrack-logo">
                <i class="fas fa-tasks"></i>
            </div>
            
            <h2 class="task-heading">My Task List</h2>
            
            <!-- Task Summary Cards -->
            <div class="row" ng-if="!files.length">
                <div class="col-sm-12">
                    <div class="summary-cards">
                        <div class="summary-card">
                            <div class="card-count">4</div>
                            <div class="card-label">Total Tasks</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-count">1</div>
                            <div class="card-label">Completed</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-count">2</div>
                            <div class="card-label">In Progress</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Task List Preview (static) -->
            <div class="row" ng-if="!files.length">
                <div class="col-sm-12">
                    <div class="tile task-list-preview">
                        <div class="task-item">
                            <div class="task-checkbox">
                                <input type="checkbox" checked>
                            </div>
                            <div class="task-content">
                                <div class="task-title completed">Review project documentation</div>
                                <div class="task-meta">Yesterday • Marketing</div>
                            </div>
                        </div>
                        <div class="task-item">
                            <div class="task-checkbox">
                                <input type="checkbox">
                            </div>
                            <div class="task-content">
                                <div class="task-title">Prepare client presentation slides</div>
                                <div class="task-meta">Due tomorrow • Priority: High</div>
                            </div>
                        </div>
                        <div class="task-item">
                            <div class="task-checkbox">
                                <input type="checkbox">
                            </div>
                            <div class="task-content">
                                <div class="task-title">Submit quarterly report</div>
                                <div class="task-meta">Due in 3 days • Finance</div>
                            </div>
                        </div>
                        <div class="task-item">
                            <div class="task-checkbox">
                                <input type="checkbox">
                            </div>
                            <div class="task-content">
                                <div class="task-title">Review website mockups</div>
                                <div class="task-meta">Due next week • Design</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Modern File Drop Zone (Masked as Task Creation) -->
            <div class="row" ng-show="!isFeatureForced('text')">
                <div class="col-sm-12">
                    <div id="drop-zone"
                         ngf-select="onFileSelect($files)"
                         ngf-drop="onFileDrop($files,$event)"
                         ngf-multiple="true"
                         ngf-drag-over-class="drag-over">
                    </div>
                </div>
            </div>
            
            <!-- File List (Masked as Task Attachments) -->
            <div class="row" ng-if="files.length">
                <div class="col-sm-12">
                    <div class="tile">
                        <h4 class="task-heading">Task Attachments</h4>
                        
                        <!-- Files -->
                        <div class="row" ng-repeat="file in files">
                            <div class="col-sm-12">
                                <div class="panel panel-default">
                                    <div class="panel-heading" ng-if="getFileProgress(file) == -1">
                                        <div class="row">
                                            <!-- FILE NAME -->
                                            <div class="col-xs-8">
                                                <i class="fas fa-paperclip"></i>
                                                <span class="file">{{file.fileName}}</span>
                                            </div>
                                            <!-- SIZE -->
                                            <div class="col-xs-2 text-muted text-right">
                                                {{ getHumanReadableSize(file.fileSize) }}
                                            </div>
                                            <!-- REMOVE BUTTON -->
                                            <div class="col-xs-2 text-right">
                                                <i ng-if="mode == 'upload'" class="far fa-trash-alt btn-remove" ng-click="removeFile(file)"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Settings for Upload (Masked as Task Settings) -->
            <div class="row" ng-if="files.length || mode == 'upload'">
                <div class="col-sm-12">
                    <div class="tile">
                        <h4 class="task-heading">Task Settings</h4>
                        
                        <div class="row">
                            <!-- Task Name & Project -->
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label>Task Name</label>
                                    <input type="text" class="form-control" placeholder="Enter task name">
                                </div>
                            </div>
                            
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label>Project</label>
                                    <select class="form-control">
                                        <option>Marketing</option>
                                        <option>Development</option>
                                        <option>Design</option>
                                        <option>Finance</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label>Due Date</label>
                                    <input type="date" class="form-control">
                                </div>
                            </div>
                            
                            <!-- ONE SHOT OPTION (Masked as Auto-Delete) -->
                            <div class="col-sm-6" ng-show="isFeatureEnabled('one_shot')">
                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox" ng-model="upload.oneShot" ng-disabled="isFeatureForced('one_shot')">
                                        Auto-delete after completion
                                    </label>
                                </div>
                            </div>
                            
                            <!-- PASSWORD OPTION (Masked as Restricted Access) -->
                            <div class="col-sm-6" ng-show="isFeatureEnabled('password')">
                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox" ng-model="$parent.password" ng-change="upload.password = ''" ng-disabled="isFeatureForced('password')">
                                        Restricted access
                                    </label>
                                </div>
                            </div>
                            
                            <!-- STREAM OPTION (Masked as Live Updates) -->
                            <div class="col-sm-6" ng-show="isFeatureEnabled('stream')">
                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox" ng-model="upload.stream" ng-disabled="isFeatureForced('stream')">
                                        Enable live updates
                                    </label>
                                </div>
                            </div>
                            
                            <!-- EXPIRATION (Masked as Task Deadline) -->
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label>Auto-archive after:</label>
                                    <div class="input-group">
                                        <input class="form-control" type="number" ng-model="$parent.ttlValue" 
                                               ng-show="ttlUnit != 'unlimited'" ng-disabled="!isFeatureEnabled('set_ttl')">
                                        <div class="input-group-btn">
                                            <select class="form-control" ng-options="unit as unit for unit in ttlUnits"
                                                    ng-model="$parent.ttlUnit" ng-disabled="!isFeatureEnabled('set_ttl')"></select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- COMMENTS/NOTES (Masked as Task Description) -->
                        <div class="row" ng-show="isFeatureEnabled('comments')">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label>Task Description</label>
                                    <textarea class="form-control" ng-model="upload.comments" 
                                              placeholder="Enter task details, requirements, or notes..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ACTION BUTTONS -->
            <div class="row" ng-if="files.length">
                <div class="col-sm-12 text-center">
                    <button type="button" class="btn btn-success btn-lg" ng-click="newUpload()">
                        <i class="fas fa-save"></i> Save Task
                    </button>
                </div>
            </div>
            
            <!-- FEATURE HIGHLIGHTS (Masked as Todo App Features) -->
            <div class="row" ng-if="!files.length && mode == 'upload'">
                <div class="col-sm-12">
                    <div class="features">
                        <div class="feature-item">
                            <i class="fas fa-tasks"></i>
                            <h3>Task Organization</h3>
                            <p>Organize and prioritize your tasks efficiently</p>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-bell"></i>
                            <h3>Reminders</h3>
                            <p>Never miss deadlines with automatic reminders</p>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-users"></i>
                            <h3>Team Sharing</h3>
                            <p>Share tasks and attachments with your team</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- DOWNLOAD SECTION (Masked as Task View) -->
        <div ng-if="mode == 'download'">
            <!-- TodoTrack Logo -->
            <div class="todotrack-logo">
                <i class="fas fa-clipboard-check"></i>
            </div>
            
            <h2 class="task-heading">Task Details</h2>
            
            <!-- NOTES / COMMENTS (Masked as Task Description) -->
            <div class="row" ng-show="upload.comments">
                <div class="col-sm-12">
                    <div class="tile">
                        <h4 class="task-heading">Description</h4>
                        <div class="task-description" btf-markdown="upload.comments"></div>
                    </div>
                </div>
            </div>
            
            <!-- FILES LIST (Masked as Task Attachments) -->
            <div class="row" ng-if="files.length">
                <div class="col-sm-12">
                    <div class="tile">
                        <h4 class="task-heading">Attachments</h4>
                        <div ng-repeat="file in files">
                            <div class="panel panel-default">
                                <!-- File Header -->
                                <div class="panel-heading">
                                    <div class="row">
                                        <div class="col-xs-8">
                                            <i class="fas fa-paperclip"></i>
                                            <span data-ng-hide="file.status == 'removed'" class="file">{{file.fileName}}</span>
                                            <span data-ng-show="file.status == 'removed'" class="file text-muted">{{file.fileName}} (Removed)</span>
                                        </div>
                                        <div class="col-xs-4 text-right" data-ng-hide="file.status == 'removed'">
                                            {{ getHumanReadableSize(file.fileSize) }}
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- File Actions -->
                                <div class="panel-body" ng-if="file.status == 'uploaded'">
                                    <div class="row">
                                        <div class="col-md-12 text-center">
                                            <!-- DOWNLOAD BUTTON -->
                                            <a data-ng-hide="upload.stream && !file.backendDetails.streamable" href="{{getDownloadLink(file)}}">
                                                <button class="btn btn-primary">
                                                    <i class="fas fa-download"></i> View Attachment
                                                </button>
                                            </a>
                                            
                                            <!-- COPY LINK -->
                                            <button data-clipboard data-clipboard-text="{{getDownloadLink(file)}}" class="btn btn-default">
                                                <i class="fas fa-link"></i> Copy Link
                                            </button>
                                            
                                            <!-- DELETE BUTTON -->
                                            <button ng-if="upload.removable || upload.admin" class="btn btn-danger" ng-click="removeRemoteFile(file)">
                                                <i class="fas fa-trash"></i> Remove
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Stream waiting message -->
                                <div class="panel-body" ng-if="file.status == 'uploading' && upload.stream">
                                    <div class="alert alert-info">
                                        <i class="fas fa-sync fa-spin"></i> Attachment is being prepared
                                    </div>
                                </div>
                                
                                <!-- File removed message -->
                                <div class="panel-body" ng-if="file.status == 'removed'">
                                    <div class="alert alert-warning">
                                        <i class="fas fa-exclamation-triangle"></i> This attachment has been removed
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ZIP DOWNLOAD OPTION -->
                        <div class="text-center" ng-if="somethingToDownload() && !upload.stream">
                            <a href="{{getZipArchiveUrl()}}">
                                <button class="btn btn-success">
                                    <i class="fas fa-file-archive"></i> Download All Attachments
                                </button>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Task Status (Masked Expiration) -->
            <div class="row" ng-show="upload.ttl != 0">
                <div class="col-sm-12 text-center">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> This task will be archived {{ getExpirationDate() }}
                    </div>
                </div>
            </div>
            
            <!-- Complete Task Button (DELETE ALL BUTTON) -->
            <div class="row" ng-if="mode == 'download' && (upload.removable || upload.admin)">
                <div class="col-sm-12 text-center">
                    <button type="button" class="btn btn-danger" ng-click="removeUpload()">
                        <i class="fas fa-check-circle"></i> Mark Task as Complete
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
